{% extends "base.html" %}

{% block content %}
{% set page_type = page_type|default('portfolio') %}

<div class="card">
    {% if page_type == 'portfolio' %}
    <h2>Portfolio Analysis</h2>
    <p class="info-text">Analyzing your portfolio stocks from config_portfolio.txt</p>
    {% elif page_type == 'watchlist' %}
    <h2>Watchlist Analysis</h2>
    <p class="info-text">Analyzing your watchlist stocks from config_watchlist.txt</p>
    {% elif page_type == 'market' %}
    <h2>US Market Analysis</h2>
    <p class="info-text">Analyzing major US stocks and providing top BUY recommendations</p>
    {% elif page_type == 'etf' %}
    <h2>ETF/Index Analysis</h2>
    <p class="info-text">Analyzing major ETFs and Indexes and providing top BUY recommendations</p>
    {% endif %}
    
    {% if page_type in ['portfolio', 'watchlist'] %}
    <form id="portfolio-form">
        <div class="form-group">
            <label for="symbols">Stock Symbols</label>
            <textarea id="symbols" name="symbols" rows="4" placeholder="Loading stocks from config file..." required></textarea>
            <small class="form-hint">Edit config_portfolio.txt or config_watchlist.txt to update your stock list</small>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="portfolio-period">Time Period</label>
                <select id="portfolio-period" name="period">
                    <option value="1mo">1 Month</option>
                    <option value="3mo">3 Months</option>
                    <option value="6mo">6 Months</option>
                    <option value="1y" selected>1 Year</option>
                    <option value="2y">2 Years</option>
                    <option value="5y">5 Years</option>
                </select>
            </div>
            <div class="form-group">
                <label for="top-n">Top N Recommendations</label>
                <input type="number" id="top-n" name="top_n" value="10" min="1" max="50">
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Analyze {{ 'Portfolio' if page_type == 'portfolio' else 'Watchlist' }}</button>
    </form>
    {% else %}
    <form id="{% if page_type == 'market' %}market-form{% else %}etf-form{% endif %}">
        <div class="form-row">
            <div class="form-group">
                <label for="market-period">Time Period</label>
                <select id="market-period" name="period">
                    <option value="1mo">1 Month</option>
                    <option value="3mo">3 Months</option>
                    <option value="6mo">6 Months</option>
                    <option value="1y" selected>1 Year</option>
                    <option value="2y">2 Years</option>
                    <option value="5y">5 Years</option>
                </select>
            </div>
            <div class="form-group">
                <label for="market-top-n">Top N Recommendations</label>
                <input type="number" id="market-top-n" name="top_n" value="10" min="1" max="20">
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Analyze {{ 'US Market' if page_type == 'market' else 'ETFs/Indexes' }}</button>
    </form>
    {% endif %}
    <div id="portfolio-results"></div>
</div>

<!-- Loading Overlay -->
<div id="loading" class="loading-overlay hidden">
    <div class="spinner"></div>
    <p>Analyzing stocks...</p>
</div>
{% endblock %}

{% block scripts %}
<script>
// Set page type from template - available globally
window.PAGE_TYPE = '{{ page_type|default("portfolio") }}';
</script>
{% endblock %}

